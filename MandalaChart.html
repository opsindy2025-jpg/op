<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>2025 超級曼陀羅 - 無限垂直曼陀羅計畫板</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<style>
  :root{--bg:#faf8f5;--card:#fffdf9;--text:#5d5d5d;--accent:#b8a89f;--shadow:rgba(180,160,140,0.18);--project-color:#6c757d;}
  body.dark{--bg:#1a1a1a;--card:#252525;--text:#e8e8e8;--accent:#d8c9c0;--shadow:rgba(0,0,0,0.5);--project-color:#ced4da;}
  body{margin:0;padding:20px 20px 180px;background:var(--bg);color:var(--text);
       font-family:"Noto Sans TC",sans-serif;overflow-x:auto;overflow-y:auto;min-height:100vh;}
  h1{text-align:center;color:var(--accent);font-size:2.6em;margin:20px 0 10px;}
  
  /* 新增分頁按鈕 */
  .add-mandala-btn{
    display:block;margin:40px auto;padding:16px 32px;background:#4caf50;color:#fff;border:none;
    border-radius:30px;cursor:pointer;font-size:1.3em;font-weight:600;box-shadow:0 8px 25px var(--shadow);
    width:320px;text-align:center;
  }
  .add-mandala-btn:hover{transform:scale(1.05);}

  /* 曼陀羅表格樣式 */
  .super-mandala{width:1480px;max-width:96vw;margin:60px auto;padding:40px;background:var(--card);
    border-radius:32px;box-shadow:0 30px 80px var(--shadow);position:relative;}
  .delete-super{position:absolute;top:16px;right:16px;width:44px;height:44px;
    background:#e85d75;color:#fff;border:none;border-radius:50%;font-size:26px;cursor:pointer;z-index:10;}
  .big-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:32px;}
  .big-cell{background:linear-gradient(135deg,#f9f5f2,#f0f8ff);border-radius:28px;padding:24px;
    box-shadow:0 12px 40px var(--shadow);}
  .dark .big-cell{background:linear-gradient(135deg,#2a2426,#1e2a38);}
  .big-title{text-align:center;font-size:1.5em;font-weight:700;color:var(--accent);
    margin-bottom:16px;padding:8px;background:rgba(184,168,159,0.15);border-radius:16px;}
  .center-big{background:linear-gradient(135deg,#ffe8e1,#e1f0ff)!important;
    font-size:2.2em!important;color:#8b6f5e;display:flex;align-items:center;justify-content:center;
    text-align:center;line-height:1.4;padding:40px!important;}
  .dark .center-big{background:linear-gradient(135deg,#3f2f38,#2f3a4a)!important;color:#f0d8c0;}
  .mini-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:12px;}
  .mini-cell{background:rgba(255,255,255,0.75);border-radius:12px;padding:12px 10px;
    font-size:0.92em;line-height:1.5;min-height:68px;box-shadow:0 4px 12px rgba(0,0,0,0.08);
    transition:all .3s;}
  .dark .mini-cell{background:rgba(0,0,0,0.4);}
  .mini-cell:hover{transform:translateY(-4px);}
  .mini-center{background:linear-gradient(135deg,#ffe0d8,#d8e8ff)!important;
    font-weight:700;font-size:1.1em!important;}
  .dark .mini-center{background:linear-gradient(135deg,#4a2f3a,#2f3a4a)!important;color:#f0d8c0;}

  .toolbar{position:fixed;bottom:12px;left:50%;transform:translateX(-50%);
    background:var(--card);padding:12px 22px;border-radius:50px;
    box-shadow:0 12px 40px var(--shadow);z-index:999;display:flex;gap:14px;flex-wrap:wrap;justify-content:center;}
  .btn{padding:12px 24px;background:var(--accent);color:#fff;border:none;
       border-radius:30px;cursor:pointer;font-size:15px;}
  [contenteditable]:focus{outline:2px solid var(--accent);background:rgba(184,168,159,0.15);}
</style>
</head>
<body>
<h1>2025 超級曼陀羅 - 無限垂直宇宙計畫板</h1>

<div style="text-align:center;">
  <div class="add-mandala-btn" onclick="addNewMandala()">＋ 新增曼陀羅表格</div>
</div>

<div id="mandala-container">
  <!-- 這裡會動態插入曼陀羅表格 -->
  <div class="super-mandala" data-id="mandala1">
    <button class="delete-super">×</button>
    <input type="text" value="2025 模板被動收入 500 萬 - 宇宙版" class="mandala-title">
    <input type="text" value="躺著也能財富自由（81 格全開！）" class="mandala-subtitle">
    <div class="big-grid">
      <div class="big-cell"><div class="big-title" contenteditable>里程碑與生活平衡</div><div class="mini-grid">
        <div class="mini-cell" contenteditable>Q1 20萬</div><div class="mini-cell" contenteditable>Q2 50萬</div><div class="mini-cell" contenteditable>Q3 80萬</div>
        <div class="mini-cell" contenteditable>Q4 100萬+</div><div class="mini-cell mini-center" contenteditable>每天只工作 4-5 小時</div>
        <div class="mini-cell" contenteditable>每週 3 天完全離線</div><div class="mini-cell" contenteditable>每季出國一個月</div><div class="mini-cell" contenteditable>2025/12/31 慶功</div><div class="mini-cell" contenteditable>備用</div>
      </div></div>
      <div class="big-cell"><div class="big-title" contenteditable>產品線規劃</div><div class="mini-grid">
        <div class="mini-cell" contenteditable>Next.js 企業官網</div><div class="mini-cell" contenteditable>Framer 高轉換 LP</div><div class="mini-cell" contenteditable>SaaS 完整網站</div>
        <div class="mini-cell" contenteditable>電商模板</div><div class="mini-cell mini-center" contenteditable>每月推 2 個付費模板</div>
        <div class="mini-cell" contenteditable>Notion 系統</div><div class="mini-cell" contenteditable>3D 沉浸式作品集</div><div class="mini-cell" contenteditable>Shadcn 套件</div><div class="mini-cell" contenteditable>Webflow 模板</div>
      </div></div>
      <div class="big-cell"><div class="big-title" contenteditable>銷售平台與通路</div><div class="mini-grid">
        <div class="mini-cell" contenteditable>Gumroad 主戰場</div><div class="mini-cell" contenteditable>Lemon Squeezy</div><div class="mini-cell" contenteditable>自架網站</div>
        <div class="mini-cell" contenteditable>Envato</div><div class="mini-cell mini-center" contenteditable>聯盟行銷 30-50%</div>
        <div class="mini-cell" contenteditable>小紅書數位店</div><div class="mini-cell" contenteditable>微信視頻號</div><div class="mini-cell" contenteditable>X 直達車</div><div class="mini-cell" contenteditable>備用平台</div>
      </div></div>
      <div class="big-cell"><div class="big-title" contenteditable>自動化與團隊</div><div class="mini-grid">
        <div class="mini-cell" contenteditable>ChatGPT 客服</div><div class="mini-cell" contenteditable>影片剪輯外包</div><div class="mini-cell" contenteditable>設計外包</div>
        <div class="mini-cell" contenteditable>自動報表</div><div class="mini-cell mini-center" contenteditable>年底招全職助手</div>
        <div class="mini-cell" contenteditable>SOP 完整化</div><div class="mini-cell" contenteditable>稅務自動化</div><div class="mini-cell" contenteditable>聯盟追蹤</div><div class="mini-cell" contenteditable>備用</div>
      </div></div>
      <div class="big-cell center-big">
        <div contenteditable>2025 年<br>純模板被動收入<br>500 萬</div>
      </div>
      <div class="big-cell"><div class="big-title" contenteditable>價格與收入結構</div><div class="mini-grid">
        <div class="mini-cell" contenteditable>高階 $199-$499</div><div class="mini-cell" contenteditable>中階 $79-$149</div><div class="mini-cell" contenteditable>Notion $29-$79</div>
        <div class="mini-cell" contenteditable>訂閱 $39/月</div><div class="mini-cell mini-center" contenteditable>終身會員 $999</div>
        <div class="mini-cell" contenteditable>企業授權 $1999+</div><div class="mini-cell" contenteditable>Bundle $299-$599</div>
        <div class="mini-cell" contenteditable>聯盟分潤 80-100萬</div><div class="mini-cell" contenteditable>備用</div>
      </div></div>
      <div class="big-cell"><div class="big-title" contenteditable>內容行銷引擎</div><div class="mini-grid">
        <div class="mini-cell" contenteditable>每週 1 支 YouTube</div><div class="mini-cell" contenteditable>每天 2-3 X 貼文</div><div class="mini-cell" contenteditable>每月免費模板換 Email</div>
        <div class="mini-cell" contenteditable>小紅書 15 篇爆款</div><div class="mini-cell mini-center" contenteditable>建 5 萬人名單</div>
        <div class="mini-cell" contenteditable>50 篇 SEO 文</div><div class="mini-cell" contenteditable>每月直播教學</div><div class="mini-cell" contenteditable>30 個 Podcast</div><div class="mini-cell" contenteditable>備用</div>
      </div></div>
      <div class="big-cell"><div class="big-title" contenteditable>產品開發流程</div><div class="mini-grid">
        <div class="mini-cell" contenteditable>V0 + Cursor + Claude</div><div class="mini-cell" contenteditable>每支 ≤7 天完成</div><div class="mini-cell" contenteditable>自建 Component Library</div>
        <div class="mini-cell" contenteditable>3 種風格變體</div><div class="mini-cell mini-center" contenteditable>附 30-60 分鐘教學影片</div>
        <div class="mini-cell" contenteditable>Figma + Notion 手冊</div><div class="mini-cell" contenteditable>90 天退款</div><div class="mini-cell" contenteditable>終身更新</div><div class="mini-cell" contenteditable>備用</div>
      </div></div>
      <div class="big-cell"><div class="big-title" contenteditable>未來擴展</div><div class="mini-grid">
        <div class="mini-cell" contenteditable>開設模板學校</div><div class="mini-cell" contenteditable>推出英文版</div><div class="mini-cell" contenteditable>Gumroad Top 100</div>
        <div class="mini-cell" contenteditable>進軍企業市場</div><div class="mini-cell mini-center" contenteditable>更多瘋狂想法…</div>
        <div class="mini-cell" contenteditable></div><div class="mini-cell" contenteditable></div><div class="mini-cell" contenteditable></div><div class="mini-cell" contenteditable></div>
      </div></div>
    </div>
  </div>
</div>

<div class="toolbar">
  <button class="btn" onclick="toggleDark()">深色模式</button>
  <button class="btn" onclick="saveAll()">儲存進度</button>
  <button class="btn" onclick="exportPNG()">匯出 PNG</button>
  <button class="btn" onclick="exportExcel()">匯出 Excel</button>
</div>

<style>
.mandala-title{width:100%;text-align:center;font-size:2.3em;border:none;background:transparent;color:var(--accent);font-weight:700;margin:10px 0;}
.mandala-subtitle{width:100%;text-align:center;font-size:1.4em;border:none;background:transparent;color:#a89b92;margin-bottom:20px;}
.mandala-title:focus, .mandala-subtitle:focus{outline:2px solid var(--accent);border-radius:8px;}
</style>

<script>
let nextMandalaId = 2;

window.onload = () => {
  const saved = localStorage.getItem('mandalaVerticalData');
  if (saved && confirm('偵測到上次儲存的資料，是否載入？\n\n確定 → 載入所有曼陀羅表格\n取消 → 從頭開始')) {
    document.getElementById('mandala-container').innerHTML = saved;
  } else {
    localStorage.removeItem('mandalaVerticalData');
  }
  if(localStorage.getItem('darkMode')==='true') document.body.classList.add('dark');
  bindDeleteButtons();
};

function bindDeleteButtons() {
  document.querySelectorAll('.delete-super').forEach(btn => {
    btn.onclick = function() {
      if (confirm('確定要刪除這個完整的曼 9×9×9 曼陀羅表格嗎？')) {
        this.parentElement.remove();
        saveAll();
      }
    };
  });
}

function addNewMandala() {
  const container = document.getElementById('mandala-container');
  const newMandala = document.createElement('div');
  newMandala.className = 'super-mandala';
  newMandala.setAttribute('data-id', 'mandala' + nextMandalaId++);
  
  newMandala.innerHTML = `
    <button class="delete-super">×</button>
    <input type="text" class="mandala-title" value="新曼陀羅目標 - ${new Date().toLocaleDateString('zh-TW')}">
    <input type="text" class="mandala-subtitle" value="點擊這裡修改副標題" placeholder="副標題（可選）">
    <div class="big-grid">
      ${Array.from({length:9}, (_, i) => i === 4 ? 
        `<div class="big-cell center-big"><div contenteditable>2025<br>核心目標</div></div>` :
        `<div class="big-cell">
          <div class="big-title" contenteditable>大項目標題 ${i<4 ? i+1 : i>4 ? i : ''}</div>
          <div class="mini-grid">
            ${Array(9).fill().map((_, j) => 
              `<div class="mini-cell${j===4 ? ' mini-center' : ''}" contenteditable></div>`
            ).join('')}
          </div>
        </div>`
      ).join('')}
    </div>
  `;
  container.appendChild(newMandala);
  bindDeleteButtons();
  saveAll();
  
  // 自動滾動到新表格
  newMandala.scrollIntoView({ behavior: 'smooth', block: 'center' });
}

function saveAll() {
  localStorage.setItem('mandalaVerticalData', document.getElementById('mandala-container').innerHTML);
}

function toggleDark() {
  document.body.classList.toggle('dark');
  localStorage.setItem('darkMode', document.body.classList.contains('dark'));
}

async function exportPNG() {
  for (let page of document.querySelectorAll('.super-mandala')) {
    const title = page.querySelector('.mandala-title').value.trim() || '曼陀羅';
    const canvas = await html2canvas(page, { scale: 1.8, useCORS: true });
    const a = document.createElement('a');
    a.download = title + '.png';
    a.href = canvas.toDataURL();
    a.click();
    await new Promise(r => setTimeout(r, 500));
  }
}

function exportExcel() {
  const wb = XLSX.utils.book_new();
  document.querySelectorAll('.super-mandala').forEach((page, idx) => {
    const title = page.querySelector('.mandala-title')?.value || `曼陀羅${idx + 1}`;
    const data = [[title], [page.querySelector('.mandala-subtitle')?.value || ''], []];
    
    page.querySelectorAll('.big-cell').forEach(cell => {
      const bigTitle = cell.querySelector('.big-title, [contenteditable]')?.innerText || '';
      if (bigTitle) data.push([bigTitle]);
      
      const miniCells = cell.querySelectorAll('.mini-cell');
      for (let i = 0; i < miniCells.length; i += 3) {
        data.push([
          miniCells[i]?.innerText.trim() || '',
          miniCells[i+1]?.innerText.trim() || '',
          miniCells[i+2]?.innerText.trim() || ''
        ]);
      }
      data.push([]);
    });
    
    const ws = XLSX.utils.aoa_to_sheet(data);
    ws['!cols'] = [{wch:30}, {wch:30}, {wch:30}];
    XLSX.utils.book_append_sheet(wb, ws, title.substring(0, 31));
  });
  
  XLSX.writeFile(wb, '2025_全曼陀羅匯出_' + new Date().toISOString().slice(0,10) + '.xlsx');
}
</script>
</body>
</html>